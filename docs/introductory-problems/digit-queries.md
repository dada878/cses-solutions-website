---
sidebar_position: 18
---

Digit Queries
===

題目
---
考慮一個按照遞增順序包含所有正整數的無窮字串：
`12345678910111213141516171819202122232425...`

你的任務是處理 $q$ 個查詢：第 $k$ 個字元是什麼數字？

### 輸入
- 第一行輸入一個正整數 $q$，代表查詢的數量。（$1 \le q \le 1000$）
- 接著有 $q$ 行，每行有一個正整數 $k$。（$1 \le k \le 10^{18}$）

### 輸出
輸出 $q$ 行，各自對應一個查詢。
對每個查詢，輸出字串第 $k$ 個字元。

範例測資
---

```
Input :
3
7
19
12

Output :
7
4
1
```

解釋如下：
```
1234567891011121314151617181920...
^     ^    ^      ^
1     7   12     19
```


想法
---
我們可以找第 $k$ 個字元落在哪個正整數 $n$ 裡面，又是 $n$ 從高位開始算起的哪一位數，從而找出答案。比如第 $266$ 個字元落在正整數 $125$ 裡面，並且是 $125$ 從高位開始算起的第 $2$ 位數，所以第 $266$ 個字元是 `2`。

要知道第 $266$ 個字元落在正整數 $125$ 裡面，我們可以透過觀察分析：
- 一位數有 $1$ 到 $9$，共 $9$ 個數字，佔去了前 $9$ 個字元；
- 二位數有 $10$ 到 $99$，共 $90$ 個數字，佔去了接下來共 $180$ 個字元；
- 三位數有 $100$ 到 $999$，共 $900$ 個數字，又佔去了接下來共 $2700$ 個字元。

而 $189 < 266 \le 2889$，表示第 $266$ 個字元超過了整個一位數與二位數的區域，落在某個三位數裡面。而又因為 $ 25 \cdot 3 < 266 - 189 \le 26 \cdot 3, $ 我們知道第 $266$ 個字元又恰好超過了 $25$ 個三位數，落在第 $26$ 個三位數裡，那就是在正整數 $125$ 裡面。更進一步因為 $ 266 - 189 - 25 \cdot 3 = 2, $ 我們能知道它是正整數 $125$ 從高位開始算起的第 $2$ 位數，也就是 `2`。

把這個流程一般化。我們可以發現 $\ell$ 位數的正整數有 $10^{\ell-1}$ 到 $10^\ell - 1$，共 $9 \cdot 10^{\ell-1}$ 個數字。如果說第 $k$ 個字元落在某個 $\ell$ 位數裡面，那 $\ell$ 就滿足 $\Bigl(\displaystyle\sum_{i=1}^{\ell-1} 9i \cdot 10^{i-1}\Bigr) < k \le
  \Bigl(\sum_{i=1}^\ell 9i \cdot 10^{i-1}\Bigr)
$ 接著找到 $s$ 使得 $
 s\ell < k - \Bigl(\displaystyle\sum_{i=1}^{\ell-1} 9i \cdot 10^{i-1}\Bigr) \le (s+1)\ell,
$ 就代表第 $k$ 個字元落在第 $(s+1)$ 個 $\ell$ 位數裡面，也就是在正整數 $n = 10^{\ell-1} + s$ 裡面。更進一步它會是正整數 $n$ 從高位開始算起的第 $k - \Bigl(\displaystyle\sum_{i=1}^{\ell-1} 9i \cdot 10^{i-1}\Bigr) - s\ell$ 位數。

### 範例程式碼
<details>
<summary>C++ 範例 </summary>
```cpp
#include <iostream>
#define int long long
using namespace std;

signed main() {
    ios::sync_with_stdio(0); 
    cin.tie(0); cout.tie(0);
    int q, k;
    cin >> q;
    while (q--) {
        cin >> k;
        int lv = 1, ten = 1;
        while (k >= lv * 9 * ten) {
            k -= lv * 9 * ten;
            lv++;
            ten *= 10;
        }
        int s = (k-1) / lv;
        int n = ten + s;
        for (int i = lv; i > k - s*lv; i--) {
            n /= 10;
        }
        cout << n % 10 << '\n';
    }
}
```
</details>